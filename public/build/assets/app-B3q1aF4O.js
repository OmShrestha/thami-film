$(function(e){e(".sidebar-search").on("input",function(){let t=e(this).val().toLowerCase();t.length>0?e(".sidebar ul li.nav-item").each(function(o){let s=e(this).find("p").text().toLowerCase(),n=e(this);if(s.indexOf(t)>-1)n.removeClass("d-none"),n.addClass("d-block");else{let l=0;n.find("span.sub-item").each(function(a){e(this).text().toLowerCase().indexOf(t)>-1&&(l=1)}),l==1?(n.removeClass("d-none"),n.addClass("d-block")):(n.removeClass("d-block"),n.addClass("d-none"))}}):e(".sidebar ul li.nav-item").addClass("d-block")}),e("#ajaxEditForm").attr("onsubmit","return false"),e("#ajaxForm").attr("onsubmit","return false"),e("#basic-datatables").DataTable({}),e(".datepicker").datepicker({autoclose:!0}),e("input.timepicker").timepicker({timeFormat:"H:mm p",interval:30}),e(".select2").select2();function d(t,o){t.find("div.progress").toggleClass("d-none",!o),t.find(".progressbar").toggleClass("d-none",o),t.find('input[type="file"]').prop("disabled",o),t.find(".btn").toggleClass("disabled",o),t.find(".btn i").toggleClass("fa-circle-o-notch fa-spin",o),t.find(".btn i").toggleClass("fa-folder-o",!o)}function c(t,o,s){s=typeof s>"u"?!0:s;var n=t.find("div.progress-bar");n.width(o+"%").attr("aria-valuenow",o),n.toggleClass("progress-bar-striped progress-bar-animated",s),o===0?n.html(""):n.html(o+"%")}function r(t,o,s){s=typeof s>"u"?"muted":s,t.find("small.status").prop("class","status text-"+s).html(o)}e(".drag-and-drop-zone").each(function(t){let o=e(this);o.dmUploader({url:o.attr("action"),multiple:!1,allowedTypes:"image/*",extFilter:["jpg","jpeg","png"],onDragEnter:function(){this.addClass("active")},onDragLeave:function(){this.removeClass("active")},onInit:function(){this.find(".progressbar").val("")},onComplete:function(){},onNewFile:function(s,n){if(typeof FileReader<"u"){var l=new FileReader,a=this.find("img");l.onload=function(i){a.attr("src",i.target.result)},l.readAsDataURL(n)}},onBeforeUpload:function(s){c(this,0,!0),d(this,!0),r(this,"Uploading...")},onUploadProgress:function(s,n){c(this,n)},onUploadSuccess:function(s,n){JSON.stringify(n);let l=document.getElementsByClassName("em");for(let a=0;a<l.length;a++)l[a].innerHTML="";n.status=="success"?(f(n.image+" added successfully!","Success!","success"),d(this,!1),this.find(".progressbar").val("Uploaded successfully"),this.find(".form-control[readonly]").attr("style","background-color: #28a745 !important; text-alignment: center !important; opacity: 1 !important;border: none !important;"),r(this,"Upload completed.","success")):n.status=="session_put"?(e("#image").attr("name",n.image),e("#image").val(n.filename),d(this,!1),this.find(".progressbar").val("Uploaded successfully"),this.find(".form-control[readonly]").attr("style","background-color: #28a745 !important; text-alignment: center !important; opacity: 1 !important;border: none !important;"),r(this,"Upload completed.","success")):n.status=="reload"?(d(this,!1),this.find(".progressbar").val("Uploaded successfully"),this.find(".form-control[readonly]").attr("style","background-color: #28a745 !important; text-alignment: center !important; opacity: 1 !important;border: none !important;"),r(this,"Upload completed.","success"),location.reload()):typeof n.errors.error<"u"&&typeof n.errors.file<"u"&&(document.getElementById("err"+n.id).innerHTML=n.errors.file[0])},onUploadError:function(s,n,l,a){d(this,!1),r(this,"Error: "+a,"danger")},onFallbackMode:function(){},onFileSizeError:function(s){r(this,"File excess the size limit","danger")},onFileTypeError:function(s){r(this,"File type is not an image","danger")},onFileExtError:function(s){r(this,"File extension not allowed","danger")}})}),e(".icp-dd").iconpicker();var u=function(t){var o=e.summernote.ui,s=o.button({contents:'<i class="far fa-images"></i>',tooltip:"File Manager",click:function(){let n=t.$note[0].id;e("#lfmModalSummernote").find("iframe").attr("src",""),e("#lfmModalSummernote").find("iframe").attr("src",baseurl+"/laravel-filemanager?summernote="+n),e("#lfmModalSummernote").modal("show")}});return s.render()};function m(){return"_"+Math.random().toString(36).substr(2,9)}e(".summernote").each(function(t){let o,s=e(this);s.attr("id",m()),e(this).data("height")?o=e(this).data("height"):o=200,e(".summernote").eq(t).summernote({height:o,dialogsInBody:!0,dialogsFade:!1,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["height",["height"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","image","picture","video"]],["view",["fullscreen","codeview","help"]]],buttons:{image:u},popover:{image:[["image",["resizeFull","resizeHalf","resizeQuarter","resizeNone"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],table:[["add",["addRowDown","addRowUp","addColLeft","addColRight"]],["delete",["deleteRow","deleteCol","deleteTable"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]]},callbacks:{onImageUpload:function(n){e(".request-loader").addClass("show");let l=new FormData;l.append("image",n[0]),e.ajax({url:imgupload,method:"POST",data:l,contentType:!1,processData:!1,success:function(a){s.summernote("insertImage",a),e(".request-loader").removeClass("show")}})}}})}),e(document).on("click",".note-video-btn",function(){console.log("clicked");let t=e(this).index();e(".summernote").eq(t).parents(".modal").length>0&&(console.log("in modal"),setTimeout(()=>{e("body").addClass("modal-open")},500))});function f(t,o,s){var n={};n.message=t,n.title=o,n.icon="fa fa-bell",e.notify(n,{type:s,placement:{from:"top",align:"right"},showProgressbar:!0,time:1e3,allow_dismiss:!0,delay:4e3})}e("#submitBtn").on("click",function(t){e(t.target).attr("disabled",!0),e(".request-loader").addClass("show");let o=document.getElementById("ajaxForm"),s=new FormData(o),n=e("#ajaxForm").attr("action"),l=e("#ajaxForm").attr("method");e("#ajaxForm .summernote").length>0&&e("#ajaxForm .summernote").each(function(a){let i=e(this).summernote("code");s.delete(e(this).attr("name")),s.append(e(this).attr("name"),i)}),e.ajax({url:n,method:l,data:s,contentType:!1,processData:!1,success:function(a){if(console.log(a),e(t.target).attr("disabled",!1),e(".request-loader").removeClass("show"),e(".em").each(function(){e(this).html("")}),a=="success")location.reload();else if(typeof a.error<"u")for(let i in a)console.log(i),i!="error"&&(document.getElementById("err"+i).innerHTML=a[i][0])},error:function(a){e(".em").each(function(){e(this).html("")});for(let i in a.responseJSON.errors)console.log("err"+i),document.getElementById("err"+i).innerHTML=a.responseJSON.errors[i][0];e(".request-loader").removeClass("show"),e(t.target).attr("disabled",!1)}})}),e(".editbtn").on("click",function(){let t=e(this).data();console.log(t),delete t.toggle;for(let o in t)if(e("#in"+o).hasClass("summernote"))e("#in"+o).summernote("code",t[o]);else if(e("#in"+o).data("role")=="tagsinput")if(t[o].length>0){let s=t[o].split(" ");for(let n=0;n<s.length;n++)e("#in"+o).tagsinput("add",s[n])}else e("#in"+o).tagsinput("removeAll");else e("input[name='"+o+"']").attr("type")=="radio"?e("input[name='"+o+"']").each(function(s){e(this).val()==t[o]&&e(this).prop("checked",!0)}):e("#in"+o).val(t[o]);setTimeout(()=>{e(".jscolor").each(function(){e(this).focus(),e(this).blur()})},300)}),e("#updateBtn").on("click",function(t){e(".request-loader").addClass("show");let o=document.getElementById("ajaxEditForm"),s=new FormData(o),n=e("#ajaxEditForm").attr("action"),l=e("#ajaxEditForm").attr("method");e("#ajaxEditForm .summernote").length>0&&e("#ajaxEditForm .summernote").each(function(a){let i=e(this).summernote("code");s.delete(e(this).attr("name")),s.append(e(this).attr("name"),i)}),e.ajax({url:n,method:l,data:s,contentType:!1,processData:!1,success:function(a){if(console.log(a),e(".request-loader").removeClass("show"),e(".em").each(function(){e(this).html("")}),a=="success")location.reload();else if(typeof a.error<"u")for(let i in a)console.log(i),i!="error"&&(document.getElementById("eerr"+i).innerHTML=a[i][0])},error:function(a){for(let i in a.responseJSON.errors)document.getElementById("eerr"+i).innerHTML=a.responseJSON.errors[i][0];e(".request-loader").removeClass("show"),e(t.target).attr("disabled",!1)}})}),e(".deletebtn").on("click",function(t){t.preventDefault(),e(".request-loader").addClass("show"),swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",buttons:{confirm:{text:"Yes, delete it!",className:"btn btn-success"},cancel:{visible:!0,className:"btn btn-danger"}}}).then(o=>{o?e(this).parent(".deleteform").submit():(swal.close(),e(".request-loader").removeClass("show"))})}),e(".close-ticket").on("click",function(t){t.preventDefault(),e(".request-loader").addClass("show"),swal({title:"Are you sure?",text:"You want to close this ticket!",type:"warning",buttons:{confirm:{text:"Yes, close it!",className:"btn btn-success"},cancel:{visible:!0,className:"btn btn-danger"}}}).then(o=>{swal.close(),e(".request-loader").removeClass("show")})}),e(".bulk-check").on("change",function(){let t=e(this).data("val"),o=e(this).prop("checked");t=="all"&&(o?e(".bulk-check").each(function(){e(this).prop("checked",!0)}):e(".bulk-check").each(function(){e(this).prop("checked",!1)}));let s=0;e(".bulk-check").each(function(){e(this).prop("checked")&&(s=1)}),s==1?(e(".bulk-delete").addClass("d-inline-block"),e(".bulk-delete").removeClass("d-none")):(e(".bulk-delete").removeClass("d-inline-block"),e(".bulk-delete").addClass("d-none"))}),e(".bulk-delete").on("click",function(){swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",buttons:{confirm:{text:"Yes, delete it!",className:"btn btn-success"},cancel:{visible:!0,className:"btn btn-danger"}}}).then(t=>{if(t){e(".request-loader").addClass("show");let o=e(this).data("href"),s=[];e(".bulk-check:checked").each(function(){e(this).data("val")!="all"&&s.push(e(this).data("val"))});let n=new FormData;for(let l=0;l<s.length;l++)n.append("ids[]",s[l]);e.ajax({url:o,method:"POST",data:n,contentType:!1,processData:!1,success:function(l){console.log(l),e(".request-loader").removeClass("show"),l=="success"&&location.reload()}})}else swal.close()})}),window.closeLfmModal=function(t){e("#lfmModal"+t).modal("hide"),e(".modal.show").length>0&&setTimeout(function(){e("body").addClass("modal-open")},500)},window.closeLfmModalSummernote=function(){e("#lfmModalSummernote").modal("hide"),setTimeout(function(){e(".modal.show").length>0&&e("body").addClass("modal-open")},500)},e(document).ready(function(){e(".lfm-modal .fas.fa-times-circle").on("click",function(){e(this).parents(".lfm-modal").modal("hide"),setTimeout(function(){e(".modal.show",parent.document).length>0&&e("body",parent.document).addClass("modal-open")},500)}),e(".lfm-modal").on("click",function(t){!e(t.target).hasClass("modal-dialog")&&!e(t.target).parents(".modal-dialog").length&&(console.log("outside modal"),setTimeout(function(){e(".modal.show",parent.document).length>0&&e("body",parent.document).addClass("modal-open")},500))})}),window.insertImage=function(t,o){o.forEach(function(s){e("#"+t).summernote("insertImage",s)})}});
